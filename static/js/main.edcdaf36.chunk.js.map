{"version":3,"sources":["worker/server/worker.server.ts","webpack:///./src/worker/server/worker.server.ts?2088","hooks/useCanvas.ts","hooks/useCircle.ts","hooks/useMouseMove.ts","views/paint.ts","hooks/useTime.ts","views/CanvasCircle.tsx","views/usePaintCircle.ts","shared/julia.calc.ts","views/CanvasMain.tsx","views/usePaintOnMain.ts","worker/server/index.ts","hooks/useWorker.ts","worker/worker.client.ts","views/CanvasWorker.tsx","views/usePaintOnWorker.ts","views/Clock.tsx","views/ExpensiveOperation.tsx","views/View.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["inst","wrap","Worker","module","exports","f","this","useCanvas","canvasRef","useRef","ctxRef","useEffect","current","getContext","useCircle","hitTest","xRef","yRef","capturedRef","canvas","onmousedown","ev","x","y","ex","offsetX","ey","offsetY","document","body","style","cursor","window","onmousemove","pageX","pageY","onmouseup","useMouseMove","Math","sqrt","radius","K_Resolution","paintCircle","ctx","circle","beginPath","arc","PI","fillStyle","fill","fps","fractal","delta","parts","title","split","toFixed","delayed","timeout","Promise","resolve","setTimeout","useRequestAnimationFrame","animate","requestRef","previousTimeRef","callback","time","a","undefined","deltaTime","requestAnimationFrame","cancelAnimationFrame","CanvasCircle","memo","props","factor","w","width","h","height","clearRect","usePaintCircle","ref","position","top","left","bottom","jCalculateArray","options","creal","cimag","floor","h4","w4","array","Uint8ClampedArray","pallete","pallette","color","jCreateColors","j","cx","cy","i","xt","colors","glur","jAnimate","frame","sin","cos","CanvasMain","factorRef","resolution","params","values","img","ImageData","putImageData","usePaintOnMain","WorkerServer","useWorker","workerRef","worker","wrkr","then","terminate","CanvasWorker","isCalculatingRef","arrayRef","calculate","usePaintOnWorker","Clock","useState","count","setCount","c","id","setInterval","clearInterval","ts","d","Date","getHours","getMinutes","getSeconds","getMilliseconds","formatedTime","className","ExpensiveOperation","status","setStatus","final","setFinal","input","expensiveOperation","value","Comlink","st","v","o","result","marginTop","fontSize","ceil","View","blurs","useMemo","Array","from","keys","list","code","setCode","setFactor","option","setOption","expensive","setExpensive","text","setText","fetch","r","t","margin","name","type","checked","onChange","p","marginBottom","map","b","overflowY","e","target","dangerouslySetInnerHTML","__html","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.edcdaf36.chunk.js","sourcesContent":["var wrap = require('comlink').wrap,Worker = require(\"!worker-loader?{}!D:/Projects/react/julia-set/node_modules/comlink-loader/dist/comlink-worker-loader.js!D:\\\\Projects\\\\react\\\\julia-set\\\\node_modules\\\\react-scripts\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js??ref--5-oneOf-2!D:\\\\Projects\\\\react\\\\julia-set\\\\src\\\\worker\\\\server\\\\worker.server.ts\"),inst;module.exports = function f() {if (this instanceof f) return wrap(Worker());return inst || (inst = wrap(Worker()));};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"79da9ee58e17e2f21f89.worker.js\");\n};","import { useEffect, useRef } from \"react\";\r\n\r\nexport function useCanvas() {\r\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\r\n  const ctxRef = useRef<CanvasRenderingContext2D | null>(null);\r\n  useEffect(() => {\r\n    if (canvasRef.current) {\r\n      ctxRef.current = canvasRef.current.getContext(\"2d\");\r\n    }\r\n  }, []);\r\n\r\n  return { canvasRef, ctxRef };\r\n}\r\n","import { MutableRefObject } from \"react\";\r\nimport { useMouseMove } from \"./useMouseMove\";\r\n\r\nexport interface ICircle {\r\n  xRef: MutableRefObject<number>;\r\n  yRef: MutableRefObject<number>;\r\n  radius: number;\r\n}\r\n\r\nexport function useCircle(\r\n  canvasRef: MutableRefObject<HTMLCanvasElement | null>\r\n): ICircle {\r\n  const radius = 40;\r\n\r\n  const { xRef, yRef } = useMouseMove(canvasRef, ({ x, y, ex, ey }) => {\r\n    const distance = Math.sqrt((x - ex) * (x - ex) + (y - ey) * (y - ey));\r\n    return distance < radius;\r\n  });\r\n\r\n  return { xRef, yRef, radius };\r\n}\r\n","import { MutableRefObject, useEffect, useRef } from \"react\";\r\n\r\nexport function useMouseMove(\r\n  canvasRef: MutableRefObject<HTMLCanvasElement | null>,\r\n  hitTest: (points: { x: number; y: number; ex: number; ey: number }) => boolean\r\n) {\r\n  const xRef = useRef(50);\r\n  const yRef = useRef(50);\r\n\r\n  const capturedRef = useRef(false);\r\n\r\n  useEffect(() => {\r\n    const onmousedown = (ev: MouseEvent) => {\r\n      const x = xRef.current;\r\n      const y = yRef.current;\r\n      const ex = ev.offsetX || 0;\r\n      const ey = ev.offsetY || 0;\r\n\r\n      const hit = hitTest({ x, y, ex, ey });\r\n\r\n      if (hit) {\r\n        capturedRef.current = true;\r\n        document.body.style.cursor = \"grabbing\";\r\n      }\r\n    };\r\n    const onmousemove = (ev: MouseEvent) => {\r\n      if (capturedRef.current) {\r\n        xRef.current = ev.pageX;\r\n        yRef.current = ev.pageY;\r\n      }\r\n    };\r\n    const onmouseup = (ev: MouseEvent) => {\r\n      capturedRef.current = false;\r\n      document.body.style.cursor = \"grab\";\r\n    };\r\n\r\n    const canvas = canvasRef.current;\r\n    if (canvas) {\r\n      canvas.onmousedown = onmousedown;\r\n      window.onmousemove = onmousemove;\r\n      window.onmouseup = onmouseup;\r\n    }\r\n\r\n    return () => {\r\n      if (canvas) {\r\n        canvas.onmousedown = null;\r\n        window.onmousemove = null;\r\n        window.onmouseup = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return { xRef, yRef };\r\n}\r\n","import { ICircle } from \"../hooks/useCircle\";\r\n\r\nexport const K_Resolution = 640;\r\n\r\nexport function paintCircle(ctx: CanvasRenderingContext2D, circle: ICircle) {\r\n  const { xRef, yRef, radius } = circle;\r\n  const x = xRef.current;\r\n  const y = yRef.current;\r\n\r\n  ctx.beginPath();\r\n  ctx.arc(x, y, radius, 0, Math.PI * 2);\r\n  ctx.fillStyle = \"yellow\";\r\n  ctx.fill();\r\n}\r\n\r\nexport function fps(fractal: boolean, delta: number) {\r\n  const parts = document.title.split(\",\");\r\n  if (fractal) {\r\n    const parts = document.title.split(\",\");\r\n    document.title = `${parts[0] || \"\"},  FRACTAL ${(1000 / delta).toFixed(\r\n      1\r\n    )} FPS`;\r\n  } else {\r\n    document.title = `UI ${(1000 / delta).toFixed(1)} FPS  ,${parts[1] || \"\"}`;\r\n  }\r\n}\r\n","import { useEffect, useRef } from \"react\";\r\n\r\nexport const delayed = (timeout: number) =>\r\n  new Promise((resolve) => {\r\n    setTimeout(() => {\r\n      resolve(timeout);\r\n    }, timeout);\r\n  });\r\n\r\nexport function useInterval(timeout: number, callback: () => void) {\r\n  useEffect(() => {\r\n    const id = setInterval(callback, timeout);\r\n    return () => {\r\n      clearInterval(id);\r\n    };\r\n  }, []);\r\n}\r\n\r\nexport function useRequestAnimationFrame(\r\n  animate: (deltaTime: number, time: number) => Promise<unknown>\r\n) {\r\n  const requestRef = useRef<number>(0);\r\n  const previousTimeRef = useRef<number>(0);\r\n\r\n  useEffect(() => {\r\n    const callback: FrameRequestCallback = async (time) => {\r\n      if (previousTimeRef.current !== undefined) {\r\n        const deltaTime = time - previousTimeRef.current;\r\n        await animate(deltaTime, time);\r\n      }\r\n      previousTimeRef.current = time;\r\n      requestRef.current = requestAnimationFrame(callback);\r\n    };\r\n\r\n    requestRef.current = requestAnimationFrame(callback);\r\n    return () => cancelAnimationFrame(requestRef.current);\r\n  }, []);\r\n}\r\n\r\nexport function formatedTime() {\r\n  const d = new Date();\r\n  return [\r\n    `${d.getHours()}:${d.getMinutes()}`,\r\n    `${d.getSeconds()},${d.getMilliseconds()}`,\r\n  ];\r\n}\r\n","import { FC, memo } from \"react\";\r\nimport { useCanvas } from \"../hooks/useCanvas\";\r\nimport { useCircle } from \"../hooks/useCircle\";\r\nimport { K_Resolution } from \"./paint\";\r\nimport { usePaintCircle } from \"./usePaintCircle\";\r\n\r\nexport const CanvasCircle: FC<{}> = memo((props) => {\r\n  const { canvasRef, ctxRef } = useCanvas();\r\n  const circle = useCircle(canvasRef);\r\n\r\n  usePaintCircle(canvasRef, ctxRef, circle, 1);\r\n\r\n  return (\r\n    <canvas\r\n      ref={canvasRef}\r\n      width={K_Resolution}\r\n      height={K_Resolution}\r\n      style={{\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0,\r\n        bottom: 0,\r\n      }}\r\n    ></canvas>\r\n  );\r\n});\r\n","import { MutableRefObject, useRef } from \"react\";\r\nimport { ICircle } from \"../hooks/useCircle\";\r\nimport { useRequestAnimationFrame } from \"../hooks/useTime\";\r\nimport { fps, paintCircle } from \"./paint\";\r\n\r\nexport function usePaintCircle(\r\n  canvasRef: MutableRefObject<HTMLCanvasElement | null>,\r\n  ctxRef: MutableRefObject<CanvasRenderingContext2D | null>,\r\n  circle: ICircle,\r\n  factor?: number\r\n) {\r\n  const factorRef = useRef(factor || 0);\r\n  factorRef.current = factor || 0;\r\n\r\n  useRequestAnimationFrame(async (delta) => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = ctxRef.current;\r\n    if (!ctx) return;\r\n\r\n    // alpha\r\n    const w = canvasRef.current?.width || 1;\r\n    const h = canvasRef.current?.height || 1;\r\n    ctx.clearRect(0, 0, w, h);\r\n    // alpha\r\n\r\n    paintCircle(ctx, circle);\r\n\r\n    fps(false, delta);\r\n\r\n    return Promise.resolve();\r\n  });\r\n}\r\n","import glur from \"glur\";\r\nimport { IJuliaOptions, IJuliaParams } from \"./julia.types\";\r\n\r\nexport function jCalculateArray(options: IJuliaOptions) {\r\n  const { height, width, creal, cimag, factor } = options;\r\n  const f = Math.floor(factor || 0);\r\n\r\n  const w = width;\r\n  const h = height;\r\n  const h4 = w / 4;\r\n  const w4 = h / 4;\r\n\r\n  let array = new Uint8ClampedArray(w * h * 4);\r\n  const pallete = jCreateColors();\r\n\r\n  let j = 0;\r\n\r\n  for (let y = 0; y < h; y++) {\r\n    for (let x = 0; x < w; x++) {\r\n      let cx = -2 + x / w4;\r\n      let cy = -2 + y / h4;\r\n      let i = 0;\r\n\r\n      do {\r\n        const xt = cx * cx - cy * cy + creal;\r\n        cy = 2 * cx * cy + cimag;\r\n        cx = xt;\r\n        i++;\r\n      } while (cx * cx + cy * cy < 4 && i < 25);\r\n\r\n      const colors = pallete[i];\r\n      array[j + 0] = colors[0];\r\n      array[j + 1] = colors[1];\r\n      array[j + 2] = colors[2];\r\n      array[j + 3] = colors[3];\r\n\r\n      j += 4;\r\n    }\r\n  }\r\n\r\n  glur(array, w, h, f);\r\n\r\n  return array;\r\n}\r\n\r\nexport function jAnimate(frame: number): IJuliaParams {\r\n  const creal = -0.8 + 0.6 * Math.sin(frame / (3.14 * 20));\r\n  const cimag = 0.156 + 0.4 * Math.cos(frame / (3.14 * 40));\r\n  return { creal, cimag };\r\n}\r\n\r\nexport function jCreateColors() {\r\n  const pallette: number[][] = [];\r\n\r\n  for (\r\n    let x = 0;\r\n    x < 9;\r\n    x++ // this loop populates the color pallette array\r\n  ) {\r\n    let color = 31 * x; // convert the number to hex\r\n    pallette[x] = [color, color, 255, 255]; // \"#\" + color + color + \"ff\"; // colors 0-8: the Red and Green components change, Blue=FF\r\n    pallette[x + 8] = [0, 255, color, 255]; // \"#00ff\" + color; // colors 8-16: the Blue component changes, Red and Green=FF\r\n    pallette[17 + x] = [color, 0, 0, 255]; //  \"#\" + color + \"0000\"; // colors 17-25: the Red component changes, Green and Blue=0\r\n  }\r\n\r\n  return pallette;\r\n}\r\n","import { FC, memo } from \"react\";\r\nimport { useCanvas } from \"../hooks/useCanvas\";\r\nimport { K_Resolution } from \"./paint\";\r\nimport { usePaintOnMain } from \"./usePaintOnMain\";\r\n\r\nexport const CanvasMain: FC<{ factor: number }> = memo((props) => {\r\n  const { canvasRef, ctxRef } = useCanvas();\r\n  usePaintOnMain(canvasRef, ctxRef, props.factor);\r\n\r\n  return (\r\n    <canvas ref={canvasRef} width={K_Resolution} height={K_Resolution}></canvas>\r\n  );\r\n});\r\n","import { MutableRefObject, useRef } from \"react\";\r\nimport { useRequestAnimationFrame } from \"../hooks/useTime\";\r\nimport { jAnimate, jCalculateArray } from \"../shared/julia.calc\";\r\nimport { IJuliaOptions, IJuliaResolution } from \"../shared/julia.types\";\r\nimport { fps } from \"./paint\";\r\n\r\nexport function usePaintOnMain(\r\n  canvasRef: MutableRefObject<HTMLCanvasElement | null>,\r\n  ctxRef: MutableRefObject<CanvasRenderingContext2D | null>,\r\n  factor?: number\r\n) {\r\n  const frame = useRef(0);\r\n  const factorRef = useRef(factor || 0);\r\n  factorRef.current = factor || 0;\r\n\r\n  useRequestAnimationFrame(async (delta) => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = ctxRef.current;\r\n    if (!ctx) return;\r\n\r\n    const resolution: IJuliaResolution = {\r\n      width: canvas?.width || 960,\r\n      height: canvas?.height || 540,\r\n      factor: factorRef.current,\r\n    };\r\n\r\n    frame.current = frame.current + 1;\r\n    const params = jAnimate(frame.current);\r\n\r\n    const options: IJuliaOptions = { ...resolution, ...params };\r\n    const values = jCalculateArray(options);\r\n\r\n    const img = new ImageData(values, resolution.width, resolution.height);\r\n    ctx.putImageData(img, 0, 0);\r\n\r\n    fps(true, delta);\r\n\r\n    return Promise.resolve();\r\n  });\r\n}\r\n","// eslint-disable-next-line\r\nimport WorkerServer from \"comlink-loader!./worker.server\"; // inline loader\r\nexport default WorkerServer;\r\n","import { useEffect, useRef } from \"react\";\r\nimport { createWorkerClient } from \"../worker/worker.client\";\r\nimport { IWorkerClient } from \"../worker/worker.types\";\r\nimport { delayed } from \"./useTime\";\r\n\r\nexport function useWorker() {\r\n  const workerRef = useRef<IWorkerClient | null>(null);\r\n\r\n  useEffect(() => {\r\n    const worker = createWorkerClient();\r\n    workerRef.current = worker;\r\n    return () => {\r\n      const wrkr = (worker as unknown) as Worker;\r\n      if (wrkr) {\r\n        delayed(1).then(async () => {\r\n          try {\r\n            await wrkr.terminate();\r\n          } catch (e) {}\r\n        });\r\n        workerRef.current = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return workerRef;\r\n}\r\n","import WorkerServer from \"./server\";\r\nimport { IWorkerClient } from \"./worker.types\";\r\n\r\nexport function createWorkerClient(): IWorkerClient {\r\n  const client = new WorkerServer() as IWorkerClient;\r\n  return client;\r\n}\r\n","import { FC, memo } from \"react\";\r\nimport { useCanvas } from \"../hooks/useCanvas\";\r\nimport { K_Resolution } from \"./paint\";\r\nimport { usePaintOnWorker } from \"./usePaintOnWorker\";\r\n\r\nexport const CanvasWorker: FC<{ factor: number }> = memo((props) => {\r\n  const { canvasRef, ctxRef } = useCanvas();\r\n  usePaintOnWorker(canvasRef, ctxRef, props.factor);\r\n\r\n  return (\r\n    <canvas ref={canvasRef} width={K_Resolution} height={K_Resolution}></canvas>\r\n  );\r\n});\r\n","import { MutableRefObject, useRef } from \"react\";\r\nimport { useRequestAnimationFrame } from \"../hooks/useTime\";\r\nimport { useWorker } from \"../hooks/useWorker\";\r\nimport { jAnimate } from \"../shared/julia.calc\";\r\nimport { IJuliaOptions, IJuliaResolution } from \"../shared/julia.types\";\r\nimport { fps } from \"./paint\";\r\n\r\nexport function usePaintOnWorker(\r\n  canvasRef: MutableRefObject<HTMLCanvasElement | null>,\r\n  ctxRef: MutableRefObject<CanvasRenderingContext2D | null>,\r\n  factor?: number\r\n) {\r\n  const frame = useRef(0);\r\n  const factorRef = useRef(factor || 0);\r\n  factorRef.current = factor || 0;\r\n\r\n  const workerRef = useWorker();\r\n\r\n  const isCalculatingRef = useRef(false);\r\n  const arrayRef = useRef<Uint8ClampedArray | null>(null);\r\n\r\n  useRequestAnimationFrame(async (delta) => {\r\n    const worker = workerRef.current;\r\n    if (!worker) return;\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = ctxRef.current;\r\n    if (!ctx) return;\r\n\r\n    const resolution: IJuliaResolution = {\r\n      width: canvas?.width || 960,\r\n      height: canvas?.height || 540,\r\n      factor: factorRef.current,\r\n    };\r\n\r\n    frame.current = frame.current + 1;\r\n    const params = jAnimate(frame.current);\r\n\r\n    const options: IJuliaOptions = { ...resolution, ...params };\r\n\r\n    if (!isCalculatingRef.current) {\r\n      isCalculatingRef.current = true;\r\n      arrayRef.current = await worker.calculate(options);\r\n      isCalculatingRef.current = false;\r\n    }\r\n\r\n    const array = arrayRef.current;\r\n    if (array) {\r\n      const img = new ImageData(array, resolution.width, resolution.height);\r\n      ctx.putImageData(img, 0, 0);\r\n    }\r\n\r\n    fps(true, delta);\r\n\r\n    return Promise.resolve();\r\n  });\r\n}\r\n","import { FC, memo, useState } from \"react\";\r\nimport { formatedTime, useInterval } from \"../hooks/useTime\";\r\n\r\nexport const Clock: FC<{}> = memo(() => {\r\n  const [count, setCount] = useState(0);\r\n\r\n  useInterval(1, () => {\r\n    setCount((c) => c + 1);\r\n  });\r\n\r\n  const ts = formatedTime();\r\n\r\n  return (\r\n    <header className=\"App-header\">\r\n      <p>Julia set</p>\r\n      <p>{count}</p>\r\n      <p>{ts[0]}</p>\r\n      <p>{ts[1]}</p>\r\n    </header>\r\n  );\r\n});\r\n","import * as Comlink from \"comlink\";\r\nimport { FC, memo, useEffect, useState } from \"react\";\r\nimport { delayed } from \"../hooks/useTime\";\r\nimport { useWorker } from \"../hooks/useWorker\";\r\n\r\nexport const ExpensiveOperation: FC<{}> = memo(() => {\r\n  const [status, setStatus] = useState(0);\r\n  const [final, setFinal] = useState(\"\");\r\n\r\n  const workerRef = useWorker();\r\n\r\n  const input = 5 * 1000 * 1000 * 1000;\r\n\r\n  useEffect(() => {\r\n    const worker = workerRef.current;\r\n    if (worker) {\r\n      const callback = (st: number) => setStatus(st);\r\n      const ask = (v: number) => delayed(1).then(() => v * 3);\r\n\r\n      worker\r\n        .expensiveOperation(\r\n          { value: input },\r\n          Comlink.proxy(callback),\r\n          Comlink.proxy(ask)\r\n        )\r\n        .then((o) => setFinal(o.result.toFixed()));\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <div style={{ marginTop: 16, fontSize: 16 }}>\r\n      <p>Expensive</p>\r\n      <p>Operation</p>\r\n      <p>input</p>\r\n      <p>{input}</p>\r\n      <p>done</p>\r\n      <p>{Math.ceil(status + 1).toFixed()} %</p>\r\n      <p>final result</p>\r\n      <p>{final}</p>\r\n    </div>\r\n  );\r\n});\r\n","import { FC, useEffect, useMemo, useState } from \"react\";\r\nimport { CanvasCircle } from \"./CanvasCircle\";\r\nimport { CanvasMain } from \"./CanvasMain\";\r\nimport { CanvasWorker } from \"./CanvasWorker\";\r\nimport { Clock } from \"./Clock\";\r\nimport { ExpensiveOperation } from \"./ExpensiveOperation\";\r\n\r\nexport const View: FC<{}> = () => {\r\n  const blurs = useMemo(() => Array.from(Array(14).keys()), []);\r\n  const list = useMemo(() => Array.from(Array(10000).keys()), []);\r\n\r\n  const [code, setCode] = useState(\"main\");\r\n  const [factor, setFactor] = useState(2);\r\n  const [option, setOption] = useState(0);\r\n  const [expensive, setExpensive] = useState(false);\r\n\r\n  const [text, setText] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    //\r\n    fetch(\"https://unpkg.com/react@17.0.2/umd/react.development.js\")\r\n      .then((r) => r.text())\r\n      .then((t) => {\r\n        setText(t);\r\n      });\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <div style={{ position: \"relative\", margin: 8 }}>\r\n        {code === \"main\" && <CanvasMain factor={factor} />}\r\n        {code === \"worker\" && <CanvasWorker factor={factor} />}\r\n        <CanvasCircle />\r\n      </div>\r\n      <div>\r\n        <Clock />\r\n        <label>\r\n          <p>Expensive Worker</p>\r\n          <p>Operation</p>\r\n          <input\r\n            name=\"expensive\"\r\n            type=\"checkbox\"\r\n            checked={expensive}\r\n            onChange={() => setExpensive((p) => !p)}\r\n          />\r\n        </label>\r\n        {expensive && <ExpensiveOperation />}\r\n      </div>\r\n      <div style={{ width: 210 }}>\r\n        <div style={{ marginBottom: 40 }}>\r\n          <p>\r\n            <input\r\n              type=\"radio\"\r\n              key={\"main\"}\r\n              value={\"main\"}\r\n              name={`Paint on Main thread`}\r\n              checked={code === \"main\"}\r\n              onChange={() => setCode(\"main\")}\r\n            />\r\n            <span>Paint on Main thread</span>\r\n          </p>\r\n          <p>\r\n            <input\r\n              type=\"radio\"\r\n              key={\"worker\"}\r\n              value={\"worker\"}\r\n              name={`Paint on Worker thread`}\r\n              checked={code === \"worker\"}\r\n              onChange={() => setCode(\"worker\")}\r\n            />\r\n            <span>Paint on Worker thread</span>\r\n          </p>\r\n        </div>\r\n        <div>\r\n          {blurs.map((v, i) => {\r\n            const b = v * 2;\r\n            return (\r\n              <p key={i}>\r\n                <input\r\n                  type=\"radio\"\r\n                  key={i}\r\n                  value={b}\r\n                  name={`Blur ${b} px`}\r\n                  checked={factor === b}\r\n                  onChange={() => setFactor(b)}\r\n                />\r\n                <span>Blur {b} px</span>\r\n              </p>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <div style={{ overflowY: \"scroll\", width: 150, height: 640 }}>\r\n          {list.map((v) => {\r\n            return (\r\n              <p key={v}>\r\n                <input\r\n                  type=\"radio\"\r\n                  key={v}\r\n                  value={v}\r\n                  name={`Option ${v}`}\r\n                  checked={option === v}\r\n                  onChange={(e) => setOption(+e.target.value)}\r\n                />\r\n                <span>Option {v}</span>\r\n              </p>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n      <div\r\n        style={{\r\n          overflowY: \"scroll\",\r\n          width: 400,\r\n          height: 640,\r\n        }}\r\n        dangerouslySetInnerHTML={{ __html: text }}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\nimport \"./App.css\";\nimport { View } from \"./views/View\";\n\nfunction App() {\n  return <View />;\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}